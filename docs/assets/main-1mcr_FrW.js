(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();var f={},i={};Object.defineProperty(i,"__esModule",{value:!0});i.permutations=i.polarToRectangular=I=i.makeBoundedLinear=$=i.makeLinear=i.sum=i.countMap=N=i.initializedArray=i.count=i.zip=i.FIGURE_SPACE=i.NON_BREAKING_SPACE=i.dateIsValid=i.MIN_DATE=i.MAX_DATE=i.makePromise=i.filterMap=i.pick=i.pickAny=i.csvStringToArray=i.parseTimeT=i.parseIntX=i.parseFloatX=i.getAttribute=i.followPath=i.parseXml=i.testXml=T=i.sleep=D=i.assertClass=void 0;function U(t,e,n="Assertion Failed."){const r=o=>{throw new Error(`${n}  Expected type:  ${e.name}.  Found type:  ${o}.`)};if(t===null)r("null");else if(typeof t!="object")r(typeof t);else if(!(t instanceof e))r(t.constructor.name);else return t;throw new Error("wtf")}var D=i.assertClass=U;function Y(t){return new Promise(e=>setTimeout(e,t))}var T=i.sleep=Y;function R(t){const n=new DOMParser().parseFromString(t,"application/xml");for(const r of Array.from(n.querySelectorAll("parsererror")))if(r instanceof HTMLElement)return{error:r};return{parsed:n}}i.testXml=R;function Z(t){if(t!==void 0)return R(t)?.parsed?.documentElement}i.parseXml=Z;function B(t,...e){for(const n of e){if(t===void 0)return;if(typeof n=="number")t=t.children[n];else{const r=t.getElementsByTagName(n);if(r.length!=1)return;t=r[0]}}return t}i.followPath=B;function K(t,e,...n){if(e=B(e,...n),e!==void 0&&e.hasAttribute(t))return e.getAttribute(t)??void 0}i.getAttribute=K;function G(t){if(t==null)return;const e=parseFloat(t);if(isFinite(e))return e}i.parseFloatX=G;function X(t){const e=G(t);if(e!==void 0)return e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER||e!=Math.floor(e)?void 0:e}i.parseIntX=X;function Q(t){if(typeof t=="string"&&(t=X(t)),t!=null&&!(t<=0))return new Date(t*1e3)}i.parseTimeT=Q;const J=t=>{const e=/(,|\r?\n|\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^,\r\n]*))/gi,n=[[]];let r;for(;r=e.exec(t);)r[1].length&&r[1]!==","&&n.push([]),n[n.length-1].push(r[2]!==void 0?r[2].replace(/""/g,'"'):r[3]);return n};i.csvStringToArray=J;function ee(t){const e=t.values().next();if(!e.done)return e.value}i.pickAny=ee;function te(t){return t[Math.random()*t.length|0]}i.pick=te;function ne(t,e){const n=[];return t.forEach((r,o)=>{const s=e(r,o);s!==void 0&&n.push(s)}),n}i.filterMap=ne;function re(){let t,e;return{promise:new Promise((r,o)=>{t=r,e=o}),resolve:t,reject:e}}i.makePromise=re;i.MAX_DATE=new Date(864e13);i.MIN_DATE=new Date(-864e13);function oe(t){return isFinite(t.getTime())}i.dateIsValid=oe;i.NON_BREAKING_SPACE=" ";i.FIGURE_SPACE=" ";function*se(...t){const e=t.map(n=>n[Symbol.iterator]());for(;;){const n=e.map(r=>r.next());if(n.some(({done:r})=>r))break;yield n.map(({value:r})=>r)}}i.zip=se;function*ie(t=0,e=1/0,n=1){for(let r=t;r<e;r+=n)yield r}i.count=ie;function O(t,e){const n=[];for(let r=0;r<t;r++)n.push(e(r));return n}var N=i.initializedArray=O;i.countMap=O;function ae(t){return t.reduce((e,n)=>e+n,0)}i.sum=ae;function le(t,e,n,r){const o=(r-e)/(n-t);return function(s){return(s-t)*o+e}}var $=i.makeLinear=le;function ce(t,e,n,r){n<t&&([t,e,n,r]=[n,r,t,e]);const o=(r-e)/(n-t);return function(s){return s<=t?e:s>=n?r:(s-t)*o+e}}var I=i.makeBoundedLinear=ce;function de(t,e){return{x:Math.sin(e)*t,y:Math.cos(e)*t}}i.polarToRectangular=de;function*H(t,e=[]){if(t.length==0)yield e;else for(let n=0;n<t.length;n++){const r=t[n],o=[...e,r],s=[...t.slice(0,n),...t.slice(n+1)];yield*H(s,o)}}i.permutations=H;Object.defineProperty(f,"__esModule",{value:!0});f.download=f.createElementFromHTML=f.getHashInfo=f.getAudioBalanceControl=f.getBlobFromCanvas=f.loadDateTimeLocal=x=f.getById=void 0;const V=i;function ue(t,e){const n=document.getElementById(t);if(!n)throw new Error("Could not find element with id "+t+".  Expected type:  "+e.name);if(n instanceof e)return n;throw new Error("Element with id "+t+" has type "+n.constructor.name+".  Expected type:  "+e.name)}var x=f.getById=ue;function pe(t,e,n="milliseconds"){let r;switch(n){case"minutes":{r=e.getSeconds()*1e3+e.getMilliseconds();break}case"seconds":{r=e.getMilliseconds();break}case"milliseconds":{r=0;break}default:throw new Error("wtf")}t.valueAsNumber=+e-e.getTimezoneOffset()*6e4-r}f.loadDateTimeLocal=pe;function fe(t){const{reject:e,resolve:n,promise:r}=(0,V.makePromise)();return t.toBlob(o=>{o?n(o):e(new Error("blob is null!"))}),r}f.getBlobFromCanvas=fe;function he(t){const e=new AudioContext,n=e.createMediaElementSource(t),r=new StereoPannerNode(e,{pan:0});return n.connect(r).connect(e.destination),o=>{r.pan.value=o}}f.getAudioBalanceControl=he;function ge(){const t=new Map;return/^#?(.*)$/.exec(location.hash.replace("+","%20"))[1].split("&").forEach(r=>{const o=r.split("=",2);if(o.length==2){const s=decodeURIComponent(o[0]),a=decodeURIComponent(o[1]);t.set(s,a)}}),t}f.getHashInfo=ge;function me(t,e){var n=document.createElement("div");return n.innerHTML=t.trim(),(0,V.assertClass)(n.firstChild,e,"createElementFromHTML:")}f.createElementFromHTML=me;function we(t,e){var n=document.createElement("a");if(n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),n.setAttribute("download",t),document.createEvent){var r=document.createEvent("MouseEvents");r.initEvent("click",!0,!0),n.dispatchEvent(r)}else n.click()}f.download=we;function k(t,e){const n=t%e;return n<0?n+Math.abs(e):n}class F{constructor(e){this.onWake=e,this.callback=this.callback.bind(this),requestAnimationFrame(this.callback)}#e=!1;cancel(){this.#e=!0}callback(e){this.#e||(requestAnimationFrame(this.callback),this.onWake(e))}}function ye(t,e){if(isNaN(t.slope)||isNaN(e.slope)||t.slope==e.slope)return;const n=t.slope==1/0||t.slope==-1/0,r=e.slope==1/0||e.slope==-1/0;if(n&&r)return;const o=n?t.x0:r?e.x0:(e.y0-e.slope*e.x0-t.y0+t.slope*t.x0)/(t.slope-e.slope),s=n?e.slope*(o-e.x0)+e.y0:t.slope*(o-t.x0)+t.y0;return{x:o,y:s}}function q(t,e){return{x:Math.cos(e)*t,y:Math.sin(e)*t}}function Ae(t){for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t}const g=Math.PI,w=2*g,p=g/2,j=p/2;function ve(t){if(t%4==0)throw new Error("TODO");const e=N(t+1,o=>{const s=o/t,a=3*p-s*w,l=q(.5,a),c=a-p;return{t:s,point:l,direction:c}});return N(t,o=>({from:e[o],to:e[o+1]})).map(o=>{const s=ye({x0:o.from.point.x,y0:o.from.point.y,slope:Math.tan(o.from.direction)},{x0:o.to.point.x,y0:o.to.point.y,slope:Math.tan(o.to.direction)});if(!s)throw new Error("wtf");return{controlPoint:s,segment:o}})}const L=ve(10);window.CIRCLE=L;class E{randomizeDirection(){this.yAngle=Math.random()*w-g,this.zAngle=Math.random()*w-g}async randomizeDirectionAndAnimate(e){const n=performance.now(),r=n+e,o=["yAngle","zAngle"].map(s=>{const a=this[s],l=(Math.random()*5|0)-2,c=Math.random()*w-g,d=c+l*w,v=I(n,a,r,d),m=new F(h=>{this[s]=v(h)});return{property:s,animationLoop:m,newAngle:c}});await T(e),o.forEach(({property:s,animationLoop:a,newAngle:l})=>{a.cancel(),this[s]=l})}static FORMAT=Intl.NumberFormat("en-US",{notation:"standard"}).format;static createHighlight(e,n){if(e<0||e>1||!isFinite(e))throw new Error("wtf");if(n<0||n>1||!isFinite(n))throw new Error("wtf");const r=$(0,1,1,-1),o=$(1,1,0,-1);return this.squashedCircle(r(e),o(n),"real")}static squashedCircle(e,n,r){const o=L.length/2,s=L.map(({controlPoint:l,segment:c},d)=>{const v=d<o?e:n,m={x:l.x*v,y:l.y},h=c.to.point,y={x:h.x*v,y:h.y};return{control:m,final:y}}),a=this.FORMAT;switch(r){case"real":{const l=s.at(-1).final;let c=`M ${a(l.x)}, ${a(l.y)} `;return s.forEach(d=>{c+=`Q ${a(d.control.x)},${a(d.control.y)} ${a(d.final.x)},${a(d.final.y)} `}),c}case"vertices":{let l="";return s.forEach(c=>{l+=`M ${a(c.final.x)},${a(c.final.y)} L ${a(c.final.x)},${a(c.final.y)} `}),l}case"control points":{let l="";return s.forEach(c=>{l+=`M ${a(c.control.x)},${a(c.control.y)} L ${a(c.control.x)},${a(c.control.y)} `}),l}case"control poly":{const l=s.at(-1).control;let c=`M ${a(l.x)}, ${a(l.y)} `;return s.forEach(d=>{c+=`L ${a(d.control.x)},${a(d.control.y)} `}),c}case"vectors":{let c="";return L.forEach((d,v)=>{const{point:m,direction:h}=d.segment.to,y=q(.2,h);c+=`M ${a(m.x)},${a(m.y)} L ${a(m.x+y.x)},${a(m.y+y.y)} `}),c+this.squashedCircle(1,1,"control points")}default:throw new Error("wtf")}}#e=document.createElementNS("http://www.w3.org/2000/svg","g");get top(){return this.#e}#r=document.createElementNS("http://www.w3.org/2000/svg","circle");#t=document.createElementNS("http://www.w3.org/2000/svg","path");#n=document.createElementNS("http://www.w3.org/2000/svg","circle");get listener(){return this.#n}constructor(){this.#e.append(this.#r,this.#t,this.#n),this.#e.classList.add("sphere")}#o=0;get yAngle(){return this.#o}set yAngle(e){const n=k(e,w);if(n<g){const r=(1-Math.cos(n))/2;this.updateWhite(0,r)}else{const r=(1+Math.cos(n))/2;this.updateWhite(r,1)}this.#o=e,this.updateDetectors(...this.#i)}#s=0;get zAngle(){return this.#s}set zAngle(e){this.#t.style.transform=`rotate(${e}rad)`,this.#s=e,this.updateDetectors(...this.#i)}#a=0;get x(){return this.#a}set x(e){this.#a=e,this.#e.style.setProperty("--x",e+"px")}#l=0;get y(){return this.#l}set y(e){this.#l=e,this.#e.style.setProperty("--y",e+"px")}#c=1;get diameter(){return this.#c}set diameter(e){this.#c=e,this.#e.style.setProperty("--diameter",e.toString())}updateWhite(e,n){const r=E.createHighlight(e,n);return this.#t.setAttribute("d",r),r}#i=[];addDetector(e=0){const n=new Ee(this.top);this.#i.push(n),n.direction=e;const r=this.updateDetectors.bind(this);return r(n),{get direction(){return n.direction},set direction(s){n.direction=s,r(n)},get orange(){return n.orange}}}updateDetectors(...e){if(e.length>0){const n=k(this.#o,w)>g,r=k(this.#s+(n?g:0),w),o={flipped:n,orangeStart:r,yAngle:this.#o,zAngle:this.#s,detectors:new Array};e.forEach(s=>{const a=k(s.direction-r,w),l=a<g;s.orange=l,o.detectors.push({position:a,resultIsOrange:l,detector:s})}),console.log(o)}}}class Ee{#e=document.createElementNS("http://www.w3.org/2000/svg","g");#r=document.createElementNS("http://www.w3.org/2000/svg","circle");constructor(e){const n=document.createElementNS("http://www.w3.org/2000/svg","polygon"),r=this.#r;this.#e.append(n,r),e.appendChild(this.#e),n.setAttribute("points","0.5 0,  0.6 -0.06,  0.6 -0.02,  0.77 -0.02,  0.77 0.02,  0.6 0.02,  0.6 0.06"),r.style.strokeWidth="0.03",r.style.stroke="black",r.style.fill="",r.cx.baseVal.value=.77,r.cy.baseVal.value=0,r.r.baseVal.value=.07}#t=!0;get orange(){return this.#t}set orange(e){this.#r.style.fill=e?"#ff7d00":"white"}#n=0;get direction(){return this.#n}set direction(e){this.#n=e,this.#e.style.transform=`rotate(${E.FORMAT(e)}rad)`}}{const t=x("overview1",SVGSVGElement),e=new E;e.x=.5,e.y=.5,t.appendChild(e.top)}async function Me(){const t=[[{description:"<u>toward you</u>",yAngle:0},{description:"<u>away</u> from you",yAngle:g}],[{description:"<u>up</u> <canvas data-up-arrow></canvas>",yAngle:p,zAngle:-p},{description:"<u>down</u> <canvas data-down-arrow></canvas>",yAngle:p,zAngle:p}],[{description:"to your <u>left</u> <canvas data-left-arrow></canvas>",yAngle:p,zAngle:g},{description:"to your <u>right</u> <canvas data-right-arrow></canvas>",yAngle:p,zAngle:0}]],e=x("overview2svg",SVGSVGElement),n=new E;n.x=.5,n.y=.5,e.appendChild(n.top);const r=x("overview2text",HTMLDivElement);async function o(a,l){r.innerHTML=`The <span class="orange">orange</span> side is pointing <span class="fade-in">${l.description}</span>.`;const d=performance.now(),v=d+2e3,m=I(d,a.yAngle,v,l.yAngle);let h;a.zAngle===void 0?l.zAngle===void 0?n.zAngle=Math.random()*w:n.zAngle=l.zAngle:l.zAngle===void 0||(h=I(d,a.zAngle,v,l.zAngle));const y=new F(M=>{n.yAngle=m(M),h&&(n.zAngle=h(M))});await T(2e3),y.cancel(),n.yAngle=l.yAngle,typeof l.zAngle=="number"&&(n.zAngle=l.zAngle),await T(1e3)}let s={description:"",yAngle:0};for(;;){let a=function(u,A){let C=A-u;const b=C*.2;return u+=b,A-=b,C=A-u,Math.random()*C+u},l=function(u,A){function C(W){return I(0,.2,p,.4)(Math.abs(W-p))}let b=A-u;return u+=C(u)*b,A-=C(A)*b,b=A-u,Math.random()*b+u};const c=new Array;for(const u of Ae([...t])){const A=u[Math.random()*2|0];await o(s,A),c.push(A),s=A}const d=c.map(u=>u.yAngle),v=Math.min(...d),m=Math.max(...d);if(v==m)throw new Error("wtf");const h=c.flatMap(({zAngle:u})=>typeof u=="number"?k(u,w):[]);if(h.length!=2)throw new Error("wtf");let y=Math.min(...h),M=Math.max(...h),P=M-y;if(P>g&&([y,M]=[M,y+w],P=M-y,P>g))throw new Error("");const _={description:`<i>kinda</i> ${c[0].description}, ${c[1].description} and ${c[2].description}`,yAngle:l(v,m),zAngle:a(y,M)};await o(s,_),s=_}}Me();async function xe(){const t=x("overview3",SVGSVGElement),e=x("overview3triangle",SVGPathElement),n=new E;n.x=.5,n.y=.5,t.appendChild(n.top),n.yAngle=j,new F(r=>{const o=k(r/480,w);n.zAngle=o;const s=o>p&&o<3*p?"white":"#ff7d00";e.style.fill=s})}xe();const z=x("test",SVGSVGElement),S=N(5,t=>{const e=new E;switch(z.appendChild(e.top),t){case 0:{e.diameter=2,e.y=2,e.x=1,e.yAngle=j;break}case 1:{e.y=1.5,e.x=2.5,e.yAngle=p;break}case 2:{e.y=2.5,e.x=2.5,e.yAngle=p+.01;break}case 3:{e.y=.5,e.x=3.5;break}case 4:{e.y=1.5,e.x=3.5;break}default:throw new Error("wtf")}return e});window.spheres=S;new F(t=>{S[0].zAngle=t/700,S[3].yAngle=t/831,S[4].zAngle=t/607,S[4].yAngle=t/501});{const t=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttribute("d",E.squashedCircle(1,1,"real")),t.style.transform="translate(1.5px, 0.5px)",t.style.fill="orange",t.style.strokeWidth="0.1px",t.style.stroke="blue",t.style.strokeLinecap="round",z.appendChild(t)}{const t=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttribute("d",E.squashedCircle(-.6667,1,"real")),t.style.transform="translate(2.5px, 0.5px)",t.style.fill="lime",t.style.strokeLinecap="round",z.appendChild(t)}async function be(){const t=x("arrow-archetype",SVGGElement);t.id="";const e=D(t.cloneNode(!0),SVGGElement);z.appendChild(e);const n=new E;n.x=1.5,n.y=3.5,z.appendChild(n.top);const r=e.style.transform,o=$(0,30,g,130);for(n.listener.addEventListener("mousemove",s=>{const a=s.clientX,l=n.listener.getBoundingClientRect(),c=(a-l.left)/l.width*2-1,d=Math.acos(Math.min(1,Math.max(-1,c)));e.style.transform=`${r} rotate(${d}rad)`,e.style.fill=`lch(60 131.21 ${o(d)})`,console.log(c,d)});;)await n.randomizeDirectionAndAnimate(750),await T(1667)}be();
